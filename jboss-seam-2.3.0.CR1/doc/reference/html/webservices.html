<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory">Chapter 24. Web Services</title><link rel="stylesheet" href="css/seamframework.css" type="text/css"/><meta xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" name="generator" content="DocBook XSL Stylesheets V1.74.0"/><link rel="home" href="index.html" title="Seam - Contextual Components"/><link rel="up" href="index.html" title="Seam - Contextual Components"/><link rel="prev" href="cache.html" title="Chapter 23. Caching"/><link rel="next" href="remoting.html" title="Chapter 25. Remoting"/></head><body><p id="title"><a href="http://www.seamframework.org" class="site_href"><strong>SeamFramework.org</strong></a><a href="http://www.seamframework.org/Documentation" class="doc_href"><strong>Community Documentation</strong></a></p><ul class="docnav"><li class="previous"><a accesskey="p" href="cache.html"><strong>Prev</strong></a></li><li class="next"><a accesskey="n" href="remoting.html"><strong>Next</strong></a></li></ul><div class="chapter" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="webservices"/>Chapter 24. Web Services</h2></div></div></div><div class="toc"><dl><dt><span class="sect1"><a href="webservices.html#d0e21563">24.1. Configuration and Packaging</a></span></dt><dt><span class="sect1"><a href="webservices.html#d0e21587">24.2. Conversational Web Services</a></span></dt><dd><dl><dt><span class="sect2"><a href="webservices.html#d0e21617">24.2.1. A Recommended Strategy</a></span></dt></dl></dd><dt><span class="sect1"><a href="webservices.html#d0e21632">24.3. An example web service</a></span></dt><dt><span class="sect1"><a href="webservices.html#d0e21700">24.4. RESTful HTTP webservices with RESTEasy</a></span></dt><dd><dl><dt><span class="sect2"><a href="webservices.html#d0e21715">24.4.1. RESTEasy configuration and request serving</a></span></dt><dt><span class="sect2"><a href="webservices.html#d0e21903">24.4.2. Resources as Seam components</a></span></dt><dt><span class="sect2"><a href="webservices.html#d0e21977">24.4.3. Securing resources</a></span></dt><dt><span class="sect2"><a href="webservices.html#d0e22000">24.4.4. Mapping exceptions to HTTP responses</a></span></dt><dt><span class="sect2"><a href="webservices.html#d0e22057">24.4.5. Exposing entities via RESTful API</a></span></dt><dt><span class="sect2"><a href="webservices.html#d0e22225">24.4.6. Testing resources and providers</a></span></dt></dl></dd></dl></div><p>
    Seam integrates with JBossWS to allow standard Java EE web services to take full advantage of Seam's contextual framework,
    including support for conversational web services. This chapter walks through the steps required to allow web 
    services to run within a Seam environment.
  </p><div class="sect1" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e21563"/>24.1. Configuration and Packaging</h2></div></div></div><p>
      To allow Seam to intercept web service requests so that the necessary Seam contexts can be created for the request, 
      a special SOAP handler must be configured; <code class="literal">org.jboss.seam.webservice.SOAPRequestHandler</code>
      is a <code class="literal">SOAPHandler</code> implementation that does the work of managing Seam's lifecycle during the scope
      of a web service request.  
    </p><p>
      A special configuration file, <code class="literal">soap-handlers.xml</code> should be placed 
      into the <code class="literal">META-INF</code> directory of the <code class="literal">jar</code> file that contains the 
      web service classes.  This file contains the following SOAP handler configuration:
    </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_processing_instruction">&lt;?xml&nbsp;version=&quot;1.0&quot;&nbsp;encoding=&quot;UTF-8&quot;?&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">handler-chains</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">xmlns</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://java.sun.com/xml/ns/javaee&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">handler-chain</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">handler</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">handler-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">SOAP&nbsp;Request&nbsp;Handler</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">handler-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">handler-class</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.jboss.seam.webservice.SOAPRequestHandler</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">handler-class</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">handler</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">handler-chain</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">handler-chains</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre></div><div class="sect1" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e21587"/>24.2. Conversational Web Services</h2></div></div></div><p>
      So how are conversations propagated between web service requests?  Seam uses a SOAP header element present
      in both the SOAP request and response messages to carry the conversation ID from the consumer to the service,
      and back again.  Here's an example of a web service request that contains a conversation ID:
    </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">soapenv:Envelope</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">xmlns:soapenv</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span><span class="xml_plain">&nbsp;</span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">xmlns:sb</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://seambay.example.seam.jboss.org/&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">soapenv:Header</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">seam:conversationId</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">xmlns:seam</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">'http://www.jboss.org/seam/webservice'</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">4</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">seam:conversationId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">soapenv:Header</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">soapenv:Body</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">sb:setAuctionPrice</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">arg0</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">100</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">arg0</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">sb:setAuctionPrice</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">soapenv:Body</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">soapenv:Envelope</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><br />
</pre><p>
      As you can see in the above SOAP message, there is a <code class="literal">conversationId</code> element within the
      SOAP header that contains the conversation ID for the request, in this case <code class="literal">4</code>.  
      Unfortunately, because web services may be consumed by a variety of web service clients written in a 
      variety of languages, it is up to the developer to implement conversation ID propagation between individual 
      web services that are intended to be used within the scope of a single conversation.
    </p><p>
      An important thing to note is that the <code class="literal">conversationId</code> header element must be qualified
      with a namespace of <code class="literal">http://www.jboss.org/seam/webservice</code>, otherwise Seam will not be
      able to read the conversation ID from the request. Here's an example of a response to the above request message:
    </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">soap:Envelope</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">xmlns:soap</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">soap:Header</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">seam:conversationId</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">xmlns:seam</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://www.jboss.org/seam/webservice&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">4</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">seam:conversationId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">soap:Header</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">soap:Body</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">ns2:setAuctionPriceResponse</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">xmlns:ns2</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://seambay.example.seam.jboss.org/&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">soap:Body</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">soap:Envelope</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><br />
</pre><p>
      As you can see, the response message contains the same <code class="literal">conversationId</code> element as the request.
    </p><div class="sect2" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e21617"/>24.2.1. A Recommended Strategy</h3></div></div></div><p>
        As web services must be implemented as either a stateless session bean or POJO, it is recommended that for
        conversational web services, the web service acts as a facade to a conversational Seam component.
      </p><div class="mediaobject" align="center"><img src="images/ws-strategy.png" align="middle"/></div><p>
        If the web service is written as a stateless session bean, then it is also possible to make it a Seam
        component by giving it a <code class="literal">@Name</code>.  Doing this allows Seam's bijection (and other) 
        features to be used in the web service class itself. 
      </p></div></div><div class="sect1" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e21632"/>24.3. An example web service</h2></div></div></div><p>
      Let's walk through an example web service.  The code in this section all comes from the seamBay example
      application in Seam's <code class="literal">/examples</code> directory, and follows the recommended strategy as
      described in the previous section.  Let's first take a look at the web service class and one of its web
      service methods:
    </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Stateless</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Name</span><span class="java_separator">(</span><span class="java_literal">&quot;auctionService&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">WebService</span><span class="java_separator">(</span><span class="java_plain">name&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;AuctionService&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">HandlerChain</span><span class="java_separator">(</span><span class="java_plain">file&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;soap-handlers.xml&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">AuctionService</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">AuctionServiceRemote</span>
<!--  --><br/><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">WebMethod</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;login</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;username</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;password</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Identity</span><span class="java_separator">.</span><span class="java_plain">instance</span><span class="java_separator">().</span><span class="java_plain">setUsername</span><span class="java_separator">(</span><span class="java_plain">username</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Identity</span><span class="java_separator">.</span><span class="java_plain">instance</span><span class="java_separator">().</span><span class="java_plain">setPassword</span><span class="java_separator">(</span><span class="java_plain">password</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Identity</span><span class="java_separator">.</span><span class="java_plain">instance</span><span class="java_separator">().</span><span class="java_plain">login</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;</span><span class="java_type">Identity</span><span class="java_separator">.</span><span class="java_plain">instance</span><span class="java_separator">().</span><span class="java_plain">isLoggedIn</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">&nbsp;snip</span>
<!--  --><br/><span class="java_separator">}</span></pre><p>
      As you can see, our web service is a stateless session bean, and is annotated using the JWS annotations 
      from the <code class="literal">javax.jws</code> package, as defined by JSR-181.  The <code class="literal">@WebService</code> 
      annotation tells the container that this class implements a web service, and the <code class="literal">@WebMethod</code> 
      annotation on the <code class="literal">login()</code> method identifies the method as a web service method.  
      The <code class="literal">name</code> and <code class="literal">serviceName</code> attributes in the <code class="literal">@WebService</code> 
      annotation are optional.
    </p><p>
      As is required by the specification, each method that is to be exposed as a web service method must also be 
      declared in the remote interface of the web service class (when the web service is a stateless session bean).  
      In the above example, the <code class="literal">AuctionServiceRemote</code> interface must declare the <code class="literal">login()</code> 
      method as it is annotated as a <code class="literal">@WebMethod</code>.
    </p><p>
      As you can see in the above code, the web service implements a <code class="literal">login()</code> method that 
      delegates to Seam's built-in <code class="literal">Identity</code> component.  In keeping with our recommended strategy,
      the web service is written as a simple facade, passing off the real work to a Seam component.  This allows
      for the greatest reuse of business logic between web services and other clients.
    </p><p>
      Let's look at another example.  This web service method begins a new conversation by delegating to the
      <code class="literal">AuctionAction.createAuction()</code> method:
    </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><!-- <br/> --><span class="java_type">WebMethod</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;createAuction</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;title</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;description</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;categoryId</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">AuctionAction</span><span class="java_plain">&nbsp;action&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_type">AuctionAction</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_type">Component</span><span class="java_separator">.</span><span class="java_plain">getInstance</span><span class="java_separator">(</span><span class="java_type">AuctionAction</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">true</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;action</span><span class="java_separator">.</span><span class="java_plain">createAuction</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;action</span><span class="java_separator">.</span><span class="java_plain">setDetails</span><span class="java_separator">(</span><span class="java_plain">title</span><span class="java_separator">,</span><span class="java_plain">&nbsp;description</span><span class="java_separator">,</span><span class="java_plain">&nbsp;categoryId</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span></pre><p>
      And here's the code from <code class="literal">AuctionAction</code>:
    </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><!-- <br/> --><span class="java_type">Begin</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;createAuction</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;auction&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">Auction</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;auction</span><span class="java_separator">.</span><span class="java_plain">setAccount</span><span class="java_separator">(</span><span class="java_plain">authenticatedAccount</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;auction</span><span class="java_separator">.</span><span class="java_plain">setStatus</span><span class="java_separator">(</span><span class="java_type">Auction</span><span class="java_separator">.</span><span class="java_plain">STATUS_UNLISTED</span><span class="java_separator">);</span><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;durationDays&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;DEFAULT_AUCTION_DURATION</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span></pre><p>
      From this we can see how web services can participate in long running conversations, by acting as a facade
      and delegating the real work to a conversational Seam component.
    </p></div><div class="sect1" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e21700"/>24.4. RESTful HTTP webservices with RESTEasy</h2></div></div></div><p>
        Seam integrates the RESTEasy implementation of the JAX-RS specification (JSR 311). You can decide how
        "deep" the integration into your Seam application is going to be:
     </p><div class="itemizedlist"><ul><li><p>
               Seamless integration of RESTEasy bootstrap and configuration, automatic detection of resources
               and providers.
            </p></li><li><p>
               Serving HTTP/REST requests with the SeamResourceServlet, no external servlet or configuration in
               web.xml required.
            </p></li><li><p>
               Writing resources as Seam components, with full Seam lifecycle management and interception (bijection).
            </p></li></ul></div><div class="sect2" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e21715"/>24.4.1. RESTEasy configuration and request serving</h3></div></div></div><p>
            First, get the RESTEasy libraries and the <code class="literal">jaxrs-api.jar</code>, deploy them with the
            other libraries of your application. Also deploy the integration library,
            <code class="literal">jboss-seam-resteasy.jar</code>. 
         </p><p>
	         In seam-gen based projects, this can be done by appending <code class="literal">jaxrs-api.jar</code>, <code class="literal">resteasy-jaxrs.jar</code>
	         and <code class="literal">jboss-seam-resteasy.jar</code> to the <code class="literal">deployed-jars.list</code> (war deployment) or 
	         <code class="literal">deployed-jars-ear.list</code> (ear deployment) file. For a JBoss Tools based project, copy the libraries mentioned 
	         above to the <code class="literal">EarContent/lib</code> (ear deployment) or <code class="literal">WebContent/WEB-INF/lib</code> (war deployment) 
	         folder and reload the project in the IDE.
         </p><p>
            On startup, all classes annotated <code class="literal">@javax.ws.rs.Path</code> will be discovered automatically
            and registered as HTTP resources. Seam automatically accepts and serves HTTP requests with its built-in
            <code class="literal">SeamResourceServlet</code>. The URI of a resource is build as follows:
         </p><div class="itemizedlist"><ul><li><p>
                   The URI starts with the host and context path of your application,
                    e.g. <code class="literal">http://your.hostname/myapp</code>.
                </p></li><li><p>
                  Then the pattern mapped in <code class="literal">web.xml</code> for the <code class="literal">SeamResourceServlet</code>,
                   e.g <code class="literal">/seam/resource</code> if you follow the common examples, is appended.
                  Change this setting to expose your RESTful resources under a different base.
                  Note that this is a global change and other Seam resources (e.g. <code class="literal">s:graphicImage</code> and <code class="literal">s:captcha</code>)
                  are then also served under that base path.
               </p></li><li><p>
                  The RESTEasy integration for Seam then appends a configurable string to the base path, by default
                  this is <code class="literal">/rest</code>. Hence, the full base path of your resources would e.g. be
                  <code class="literal">/myapp/seam/resource/rest</code>. We recommend that you change this string in your application (details below).
                  You could for example add a version number to prepare for a future REST API upgrade of your services
                  (old clients would keep the old URI base): <code class="literal">/myapp/seam/resource/restv1</code>.
               </p></li><li><p>
                  Finally, the actual resource is available under the defined <code class="literal">@Path</code>, e.g. a resource
                  mapped with <code class="literal">@Path("/customer")</code> would be available under
                  <code class="literal">/myapp/seam/resource/rest/customer</code>.
               </p></li></ul></div><p>
            As an example, the following resource definition would return a plaintext representation for any
            GET requests using the URI <code class="literal">http://your.hostname/myapp/seam/resource/rest/customer/123</code>:
         </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Path</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_literal">&quot;/customer&quot;</span><!-- <br/> --><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">MyCustomerResource</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@GET</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Path</span><span class="java_separator">(</span><span class="java_literal">&quot;/{customerId}&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Produces</span><span class="java_separator">(</span><span class="java_literal">&quot;text/plain&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getCustomer</span><span class="java_separator">(</span><span class="java_plain">@</span><span class="java_type">PathParam</span><span class="java_separator">(</span><span class="java_literal">&quot;customerId&quot;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;id</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;</span><span class="java_separator">...;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_separator">}</span></pre><p>
            No additional configuration is required; you do not have to edit <code class="literal">web.xml</code> or any
            other setting if these defaults are acceptable. However, you can configure RESTEasy in your Seam application.
            First import the <code class="literal">resteasy</code> namespace into your XML configuration (<code class="literal">components.xml</code>) file header:
         </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">components</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">xmlns</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://jboss.org/schema/seam/components&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">xmlns:resteasy</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://jboss.org/schema/seam/resteasy&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">xmlns:xsi</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">xsi:schemaLocation</span><span class="xml_tag_symbols">=</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">http:</span><span class="xml_plain">//</span><span class="xml_attribute_name">jboss.org</span><span class="xml_plain">/</span><span class="xml_attribute_name">schema</span><span class="xml_plain">/</span><span class="xml_attribute_name">seam</span><span class="xml_plain">/</span><span class="xml_attribute_name">resteasy</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">http:</span><span class="xml_plain">//</span><span class="xml_attribute_name">jboss.org</span><span class="xml_plain">/</span><span class="xml_attribute_name">schema</span><span class="xml_plain">/</span><span class="xml_attribute_name">seam</span><span class="xml_plain">/</span><span class="xml_attribute_name">resteasy-2.3.xsd</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">http:</span><span class="xml_plain">//</span><span class="xml_attribute_name">jboss.org</span><span class="xml_plain">/</span><span class="xml_attribute_name">schema</span><span class="xml_plain">/</span><span class="xml_attribute_name">seam</span><span class="xml_plain">/</span><span class="xml_attribute_name">components</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">http:</span><span class="xml_plain">//</span><span class="xml_attribute_name">jboss.org</span><span class="xml_plain">/</span><span class="xml_attribute_name">schema</span><span class="xml_plain">/</span><span class="xml_attribute_name">seam</span><span class="xml_plain">/</span><span class="xml_attribute_name">components-2.3.xsd</span><span class="xml_attribute_value">&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre><p>
            You can then change the <code class="literal">/rest</code> prefix as mentioned earlier:
         </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">resteasy:application</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">resource-path-prefix</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;/restv1&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
</pre><p>
            The full base path to your resources is now <code class="literal">/myapp/seam/resource/restv1/{resource}</code> - note
            that your <code class="literal">@Path</code> definitions and mappings do NOT change. This is an application-wide
            switch usually used for versioning of the HTTP interface.
         </p><p>
            Seam will scan your classpath for any deployed <code class="literal">@javax.ws.rs.Path</code> resources and any
            <code class="literal">@javax.ws.rs.ext.Provider</code> classes. You can disable scanning and configure these
            classes manually:
         </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">resteasy:application</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">scan-providers</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;false&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">scan-resources</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;false&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">use-builtin-providers</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;true&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">resteasy:resource-class-names</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.foo.MyCustomerResource</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.foo.MyOrderResource</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.foo.MyStatelessEJBImplementation</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">resteasy:resource-class-names</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">resteasy:provider-class-names</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.foo.MyFancyProvider</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">resteasy:provider-class-names</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">resteasy:application</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre><p>
            The <code class="literal">use-built-in-providers</code> switch enables (default) or disables the RESTEasy built-in
            providers. We recommend you leave them enabled, as they provide plaintext, JSON, and JAXB marshalling
            out of the box.
         </p><p>
            RESTEasy supports plain EJBs (EJBs that are not Seam components) as resources. Instead of configuring the
            JNDI names in a non-portable fashion in <code class="literal">web.xml</code> (see RESTEasy documentation), you can
            simply list the EJB implementation classes, not the business interfaces, in <code class="literal">components.xml</code>
            as shown above. Note that you have to annotate the <code class="literal">@Local</code> interface of the EJB with
            <code class="literal">@Path</code>, <code class="literal">@GET</code>, and so on - not the bean implementation class. This allows
            you to keep your application deployment-portable with the global Seam <code class="literal">jndi-pattern</code> switch
            on <code class="literal">&lt;core:init/&gt;</code>. Note that plain (non-Seam component) EJB resources will not be found
            even if scanning of resources is enabled, you always have to list them manually. Again, this whole paragraph
            is only relevant for EJB resources that are not also Seam components and that do not have
            an <code class="literal">@Name</code> annotation.
         </p><p>
            Finally, you can configure media type and language URI extensions:
         </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">resteasy:application</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">resteasy:media-type-mappings</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">key</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">txt</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">key</span><span class="xml_tag_symbols">&gt;&lt;</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">text/plain</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">resteasy:media-type-mappings</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">resteasy:language-mappings</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">key</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">deutsch</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">key</span><span class="xml_tag_symbols">&gt;&lt;</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">de-DE</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">resteasy:language-mappings</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">resteasy:application</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre><p>
            This definition would map the URI suffix of <code class="literal">.txt.deutsch</code> to
            additional <code class="literal">Accept</code> and <code class="literal">Accept-Language</code> header values
            <code class="literal">text/plain</code> and <code class="literal">de-DE</code>.
         </p></div><div class="sect2" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e21903"/>24.4.2. Resources as Seam components</h3></div></div></div><p>
            Any resource and provider instances are managed by RESTEasy by default. That means a resource class
            will be instantiated by RESTEasy and serve a single request, after which it will be destroyed. This is
            the default JAX-RS lifecycle. Providers are instantiated once for the whole application and are
            effectively singletons and supposed to be stateless.
         </p><p>
            You can write resources as Seam components and benefit from the richer lifecycle management
            of Seam, and interception for bijection, security, and so on. Simply make your resource class a
            Seam component:
         </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Name</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_literal">&quot;customerResource&quot;</span><!-- <br/> --><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Path</span><span class="java_separator">(</span><span class="java_literal">&quot;/customer&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">MyCustomerResource</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">In</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">CustomerDAO</span><span class="java_plain">&nbsp;customerDAO</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@GET</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Path</span><span class="java_separator">(</span><span class="java_literal">&quot;/{customerId}&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Produces</span><span class="java_separator">(</span><span class="java_literal">&quot;text/plain&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getCustomer</span><span class="java_separator">(</span><span class="java_plain">@</span><span class="java_type">PathParam</span><span class="java_separator">(</span><span class="java_literal">&quot;customerId&quot;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;id</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;customerDAO</span><span class="java_separator">.</span><span class="java_plain">find</span><span class="java_separator">(</span><span class="java_plain">id</span><span class="java_separator">).</span><span class="java_plain">getName</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_separator">}</span></pre><p>
            An instance of <code class="literal">customerResource</code> is now handled by Seam when a request hits the
            server. This is a Seam JavaBean component that is <code class="literal">EVENT</code>-scoped, hence no different
            than the default JAX-RS lifecycle. You get full Seam injection and interception support, and all other Seam
            components and contexts are available to you. Currently also supported are <code class="literal">APPLICATION</code>
            and <code class="literal">STATELESS</code> resource Seam components. These three scopes allow you to create an effectively
            stateless Seam middle-tier HTTP request-processing application.
         </p><p>
            You can annotate an interface and keep the implementation free from JAX-RS annotations:
         </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Path</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_literal">&quot;/customer&quot;</span><!-- <br/> --><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">MyCustomerResource</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@GET</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Path</span><span class="java_separator">(</span><span class="java_literal">&quot;/{customerId}&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Produces</span><span class="java_separator">(</span><span class="java_literal">&quot;text/plain&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getCustomer</span><span class="java_separator">(</span><span class="java_plain">@</span><span class="java_type">PathParam</span><span class="java_separator">(</span><span class="java_literal">&quot;customerId&quot;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;id</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_separator">}</span></pre><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Name</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_literal">&quot;customerResource&quot;</span><!-- <br/> --><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Scope</span><span class="java_separator">(</span><span class="java_type">ScopeType</span><span class="java_separator">.</span><span class="java_plain">STATELESS</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">MyCustomerResourceBean</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">MyCustomerResource</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">In</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">CustomerDAO</span><span class="java_plain">&nbsp;customerDAO</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getCustomer</span><span class="java_separator">(</span><span class="java_type">int</span><span class="java_plain">&nbsp;id</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;customerDAO</span><span class="java_separator">.</span><span class="java_plain">find</span><span class="java_separator">(</span><span class="java_plain">id</span><span class="java_separator">).</span><span class="java_plain">getName</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_separator">}</span></pre><p>
           You can use <code class="literal">SESSION</code>-scoped Seam components. By default, the session will however be shortened
           to a single request. In other words, when an HTTP request is being processed by the RESTEasy integration code,
           an HTTP session will be created so that Seam components can utilize that context. When the request has
           been processed, Seam will look at the session and decide if the session was created only to serve that
           single request (no session identifier has been provided with the request, or no session existed for the request).
           If the session has been created only to serve this request, the session will be destroyed after the request!
         </p><p>
           Assuming that your Seam application only uses event, application, or stateless components, this procedure
           prevents exhaustion of available HTTP sessions on the server. The RESTEasy integration with Seam assumes
           by default that sessions are not used, hence anemic sessions would add up as every REST request would start
           a session that will only be removed when timed out.
         </p><p>
            If your RESTful Seam application has to preserve session state across REST HTTP requests, disable this
            behavior in your configuration file:
         </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">resteasy:application</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">destroy-session-after-request</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;false&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
</pre><p>
             Every REST HTTP request will now create a new session that will only be removed by timeout or explicit
             invalidation in your code through <code class="literal">Session.instance().invalidate()</code>.
             It is your responsibility to pass a valid session identifier along with your HTTP requests, if you want
             to utilize the session context across requests.
         </p><p>
            <code class="literal">CONVERSATION</code>-scoped resource components and mapping of conversations to temporary HTTP
            resources and paths is planned but currently not supported.
         </p><p>
            EJB Seam components are supported as REST resources. Always annotate the local business interface, not
            the EJB implementation class, with JAX-RS annotations. The EJB has to be <code class="literal">STATELESS</code>.
         </p><p>
            Sub-resources as defined in the JAX RS specification, section 3.4.1, can also be Seam component instances:
         </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Path</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_literal">&quot;/garage&quot;</span><!-- <br/> --><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Name</span><span class="java_separator">(</span><span class="java_literal">&quot;garage&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">GarageService</span>
<!--  --><br/><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Path</span><span class="java_separator">(</span><span class="java_literal">&quot;/vehicles&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">VehicleService</span><span class="java_plain">&nbsp;getVehicles</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_type">VehicleService</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_type">Component</span><span class="java_separator">.</span><span class="java_plain">getInstance</span><span class="java_separator">(</span><span class="java_type">VehicleService</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>Note</h2><p>
                RESTEasy components do not support hot redeployment. As a result, the components should never 
                be placed in the <code class="literal">src/hot</code> folder. The <code class="literal">src/main</code> folder should
                be used instead.
            </p></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>Note</h2><p>
                Provider classes can currently not be Seam components. Although you can configure an
                <code class="literal">@Provider</code> annotated class as a Seam component, it will at runtime be managed
                by RESTEasy as a singleton with no Seam interception, bijection, etc. The instance will not be
                a Seam component instance. We plan to support Seam component lifecycle for JAX-RS providers in
                the future.
            </p></div></div><div class="sect2" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e21977"/>24.4.3. Securing resources</h3></div></div></div><p>
            You can enable the Seam authentication filter for HTTP Basic and Digest authentication in
            <code class="literal">components.xml</code>:
         </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">web:authentication-filter</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">url-pattern</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;/seam/resource/rest/*&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">auth-type</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;basic&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
</pre><p>
            See the Seam security chapter on how to write an authentication routine.
         </p><p>
            After successful authentication, authorization rules with the common
            <code class="literal">@Restrict</code> and <code class="literal">@PermissionCheck</code> annotations are in effect. You can
            also access the client <code class="literal">Identity</code>, work with permission mapping, and so on. All
            regular Seam security features for authorization are available.
         </p></div><div class="sect2" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e22000"/>24.4.4. Mapping exceptions to HTTP responses</h3></div></div></div><p>
            Section 3.3.4 of the JAX-RS specification defines how checked or unchecked exceptions are handled by the
            JAX RS implementation. In addition to using an exception mapping provider as defined by JAX-RS, the integration
            of RESTEasy with Seam allows you to map exceptions to HTTP response codes within Seam's <code class="literal">pages.xml</code>
            facility. If you are already using <code class="literal">pages.xml</code> declarations, this is easier to maintain than
            potentially many JAX RS exception mapper classes.
         </p><p>
            Exception handling within Seam requires that the Seam filter is executed for your HTTP request. Ensure that
            you do filter <span class="emphasis"><em>all</em></span> requests in your <code class="literal">web.xml</code>, not - as
            some Seam examples might show - a request URI pattern that doesn't cover your REST request paths.
            The following example intercepts <span class="emphasis"><em>all</em></span> HTTP requests and enables Seam exception handling:
         </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">filter</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">filter-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">Seam&nbsp;Filter</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">filter-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">filter-class</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.jboss.seam.servlet.SeamFilter</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">filter-class</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">filter</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">filter-mapping</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">filter-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">Seam&nbsp;Filter</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">filter-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">url-pattern</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">/*</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">url-pattern</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">filter-mapping</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre><p>
            To convert the unchecked <code class="literal">UnsupportedOperationException</code> thrown by your resource
            methods to a <code class="literal">501 Not Implemented</code> HTTP status response, add the following to your
            <code class="literal">pages.xml</code> descriptor:
         </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">exception</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">class</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;java.lang.UnsupportedOperationException&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">http-error</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">error-code</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;501&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">message</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">The&nbsp;requested&nbsp;operation&nbsp;is&nbsp;not&nbsp;supported</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">message</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">http-error</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">exception</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre><p>
            Custom or checked exceptions are handled the same:
         </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">exception</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">class</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;my.CustomException&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">log</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;false&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">http-error</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">error-code</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;503&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">message</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">Service&nbsp;not&nbsp;available:&nbsp;#{org.jboss.seam.handledException.message}</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">message</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">http-error</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">exception</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre><p>
            You do not have to send an HTTP error to the client if an exception occurs. Seam allows you to map the
            exception as a redirect to a view of your Seam application. As this feature is typically used for human
            clients (web browsers) and not for REST API remote clients, you should pay extra attention to conflicting
            exception mappings in <code class="literal">pages.xml</code>.
         </p><p>
            Note that the HTTP response still passes through the servlet container, so an additional mapping might apply
            if you have <code class="literal">&lt;error-page&gt;</code> mappings in your <code class="literal">web.xml</code> configuration.
            The HTTP status code would then be mapped to a rendered HTML error page with status <code class="literal">200 OK</code>!
         </p></div><div class="sect2" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e22057"/>24.4.5. Exposing entities via RESTful API</h3></div></div></div><p>
            Seam makes it really easy to use a RESTful approach for accessing application data. One of the improvements that
            Seam introduces is the ability to expose parts of your SQL database for remote access via plain HTTP calls.
            For this purpose, the Seam/RESTEasy integration module provides two components: <code class="literal">ResourceHome</code> and
            <code class="literal">ResourceQuery</code>, which benefit from the API provided by the Seam Application Framework
            (<a class="xref" href="framework.html" title="Chapter 13. The Seam Application Framework">Chapter 13, <i>The Seam Application Framework</i></a>). These components allow you to bind domain model entity classes to an HTTP API.
         </p><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e22070"/>24.4.5.1. ResourceQuery</h4></div></div></div><p>
         		ResourceQuery exposes entity querying capabilities as a RESTful web service. By default, a simple
         		underlying Query component, which returns a list of instances of a given entity class, is created automatically. 
         		Alternatively, the ResourceQuery component can be attached to an existing Query component in more sophisticated 
         		cases. The following example demonstrates how easily ResourceQuery can be configured:
         	</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">resteasy:resource-query</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">path</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;/user&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;userResourceQuery&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">entity-class</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;com.example.User&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
</pre><p>
         		With this single XML element, a ResourceQuery component is set up. The configuration is straightforward:
         	</p><div class="itemizedlist"><ul><li><p>
         	 			The component will return a list of <code class="literal">com.example.User</code> instances.
         	 		</p></li><li><p>
         	 			The component will handle HTTP requests on the URI path <code class="literal">/user</code>.
         	 		</p></li><li><p>
         	 			The component will by default transform the data into XML or JSON (based on client's preference).
         	 			The set of supported mime types can be altered by using the <code class="literal">media-types</code> attribute,
                      for example:
         	 		</p></li></ul></div><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">resteasy:resource-query</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">path</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;/user&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;userResourceQuery&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">entity-class</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;com.example.User&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">media-types</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;application/fastinfoset&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
</pre><p>	
				Alternatively, if you do not like configuring components using XML, you can set up the component by extension:
			</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Name</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_literal">&quot;userResourceQuery&quot;</span><!-- <br/> --><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Path</span><span class="java_separator">(</span><span class="java_literal">&quot;user&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">UserResourceQuery</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">ResourceQuery</span><span class="java_operator">&lt;</span><span class="java_type">User</span><span class="java_operator">&gt;</span>
<!--  --><br/><span class="java_separator">{</span>
<!--  --><br/><span class="java_separator">}</span></pre><p>
				Queries are read-only operations, the resource only responds to GET requests. Furthermore, ResourceQuery allows
            clients  of a web service to manipulate the resultset of a query using the following path parameters:
			</p><div class="informaltable"><table border="1"><colgroup><col/><col/><col/></colgroup><thead><tr><th>Parameter name</th><th>Example</th><th>Description</th></tr></thead><tbody><tr><td>start</td><td>/user?start=20</td><td>Returns a subset of a database query result starting with the 20th entry.</td></tr><tr><td>show</td><td>/user?show=10</td><td>Returns a subset of the database query result limited to 10 entries.</td></tr></tbody></table></div><p>
				For example, you can send an HTTP GET request to <code class="literal">/user?start=30&amp;show=10</code> to get a list of
            entries representing 10 rows starting with row 30.
			</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>Note</h2><p>
                	RESTEasy uses JAXB to marshall entities. Thus, in order to be able to transfer them over the wire, you
                  need to annotate entity classes with <code class="literal">@XMLRootElement</code>. Consult the JAXB and
                  RESTEasy documentation for more information.
            	</p></div></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e22142"/>24.4.5.2. ResourceHome</h4></div></div></div><p>
         		Just as ResourceQuery makes Query's API available for remote access, so does ResourceHome for the Home
               component. The following table describes how the two APIs (HTTP and Home) are bound together.
         	</p><div class="table"><a id="d0e22147"/><p class="title"><b>Table 24.1. </b></p><div class="table-contents"><table border="1"><colgroup><col/><col/><col/><col/></colgroup><thead><tr><th>HTTP method</th><th>Path</th><th>Function</th><th>ResourceHome method</th></tr></thead><tbody><tr><td>GET</td><td>{path}/{id}</td><td>Read</td><td>getResource()</td></tr><tr><td>POST</td><td>{path}</td><td>Create</td><td>postResource()</td></tr><tr><td>PUT</td><td>{path}/{id}</td><td>Update</td><td>putResource()</td></tr><tr><td>DELETE</td><td>{path}/{id}</td><td>Delete</td><td>deleteResource()</td></tr></tbody></table></div></div><br class="table-break"/><div class="itemizedlist"><ul><li><p>
               			You can GET, PUT, and DELETE a particular user instance by sending HTTP requests to /user/{userId}
               		</p></li><li><p>
               			Sending a POST request to <code class="literal">/user</code> creates a new user entity instance and persists it.
                        Usually, you leave it up to the persistence layer to provide the entity instance with an identifier
                        value and thus an URI. Therefore, the URI is sent back to the client in the
                        <code class="literal">Location</code> header of the HTTP response.
               		</p></li></ul></div><p>
         		The configuration of ResourceHome is very similar to ResourceQuery except that you need to explicitly specify the underlying 
         		Home component and the Java type of the entity identifier property.
         	</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">resteasy:resource-home</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">path</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;/user&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;userResourceHome&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">entity-home</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;#{userHome}&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">entity-id-class</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;java.lang.Integer&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
</pre><p>Again, you can write a subclass of ResourceHome instead of XML:</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Name</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_literal">&quot;userResourceHome&quot;</span><!-- <br/> --><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Path</span><span class="java_separator">(</span><span class="java_literal">&quot;user&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">UserResourceHome</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">ResourceHome</span><span class="java_operator">&lt;</span><span class="java_type">User</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">Integer</span><span class="java_operator">&gt;</span>
<!--  --><br/><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">In</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">EntityHome</span><span class="java_operator">&lt;</span><span class="java_type">User</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;userHome</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Home</span><span class="java_operator">&lt;?</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">User</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;getEntityHome</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;userHome</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre><p>
				For more examples of ResourceHome and ResourceQuery components, take a look at the <span class="emphasis"><em>Seam Tasks</em></span> 
            example application, which demonstrates how Seam/RESTEasy integration can be used together with a jQuery web client.
            In addition, you can find more code example in the <span class="emphasis"><em>Restbay</em></span> example, which is used mainly
            for testing purposes.
			</p></div></div><div class="sect2" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e22225"/>24.4.6. Testing resources and providers</h3></div></div></div><p>
            Seam includes a unit testing utility class that helps you create unit tests for a RESTful
            architecture. Extend the <code class="literal">SeamTest</code> class as usual and use the
            <code class="literal">ResourceRequestEnvironment.ResourceRequest</code> to emulate HTTP requests/response cycles:
         </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">import</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">jboss</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">seam</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">mock</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_type">ResourceRequestEnvironment</span><!-- <br/> --><span class="java_separator">;</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;org</span><span class="java_separator">.</span><span class="java_plain">jboss</span><span class="java_separator">.</span><span class="java_plain">seam</span><span class="java_separator">.</span><span class="java_plain">mock</span><span class="java_separator">.</span><span class="java_type">EnhancedMockHttpServletRequest</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;org</span><span class="java_separator">.</span><span class="java_plain">jboss</span><span class="java_separator">.</span><span class="java_plain">seam</span><span class="java_separator">.</span><span class="java_plain">mock</span><span class="java_separator">.</span><span class="java_type">EnhancedMockHttpServletResponse</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;</span><span class="java_keyword">static</span><span class="java_plain">&nbsp;org</span><span class="java_separator">.</span><span class="java_plain">jboss</span><span class="java_separator">.</span><span class="java_plain">seam</span><span class="java_separator">.</span><span class="java_plain">mock</span><span class="java_separator">.</span><span class="java_type">ResourceRequestEnvironment</span><span class="java_separator">.</span><span class="java_type">ResourceRequest</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;</span><span class="java_keyword">static</span><span class="java_plain">&nbsp;org</span><span class="java_separator">.</span><span class="java_plain">jboss</span><span class="java_separator">.</span><span class="java_plain">seam</span><span class="java_separator">.</span><span class="java_plain">mock</span><span class="java_separator">.</span><span class="java_type">ResourceRequestEnvironment</span><span class="java_separator">.</span><span class="java_type">Method</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">MyTest</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">SeamTest</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">ResourceRequestEnvironment</span><span class="java_plain">&nbsp;sharedEnvironment</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">BeforeClass</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;prepareSharedEnvironment</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_keyword">throws</span><span class="java_plain">&nbsp;</span><span class="java_type">Exception</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sharedEnvironment&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">ResourceRequestEnvironment</span><span class="java_separator">(</span><span class="java_keyword">this</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Map</span><span class="java_operator">&lt;</span><span class="java_type">String</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">Object</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;getDefaultHeaders</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">HashMap</span><span class="java_operator">&lt;</span><span class="java_type">String</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">Object</span><span class="java_operator">&gt;</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;put</span><span class="java_separator">(</span><span class="java_literal">&quot;Accept&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;text/plain&quot;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}};</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">};</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Test</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;test</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_keyword">throws</span><span class="java_plain">&nbsp;</span><span class="java_type">Exception</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_type">Not</span><span class="java_plain">&nbsp;shared</span><span class="java_operator">:</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">ResourceRequest</span><span class="java_separator">(</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">ResourceRequestEnvironment</span><span class="java_separator">(</span><span class="java_keyword">this</span><span class="java_separator">),</span><span class="java_plain">&nbsp;</span><span class="java_type">Method</span><span class="java_separator">.</span><span class="java_plain">GET</span><span class="java_separator">,</span><span class="java_plain">&nbsp;&quot;</span><span class="java_operator">/</span><span class="java_plain">my</span><span class="java_operator">/</span><span class="java_plain">relative</span><span class="java_operator">/</span><span class="java_plain">uri</span><span class="java_separator">)</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">ResourceRequest</span><span class="java_separator">(</span><span class="java_plain">sharedEnvironment</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">Method</span><span class="java_separator">.</span><span class="java_plain">GET</span><span class="java_separator">,</span><span class="java_plain">&nbsp;&quot;</span><span class="java_operator">/</span><span class="java_plain">my</span><span class="java_operator">/</span><span class="java_plain">relative</span><span class="java_operator">/</span><span class="java_plain">uri</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">protected</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;prepareRequest</span><span class="java_separator">(</span><span class="java_type">EnhancedMockHttpServletRequest</span><span class="java_plain">&nbsp;request</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request</span><span class="java_separator">.</span><span class="java_plain">addQueryParameter</span><span class="java_separator">(</span><span class="java_literal">&quot;foo&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;123&quot;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request</span><span class="java_separator">.</span><span class="java_plain">addHeader</span><span class="java_separator">(</span><span class="java_literal">&quot;Accept-Language&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;en_US,&nbsp;de&quot;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">protected</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;onResponse</span><span class="java_separator">(</span><span class="java_type">EnhancedMockHttpServletResponse</span><span class="java_plain">&nbsp;response</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">assert</span><span class="java_plain">&nbsp;response</span><span class="java_separator">.</span><span class="java_plain">getStatus</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_operator">==</span><span class="java_plain">&nbsp;</span><span class="java_literal">200</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">assert</span><span class="java_plain">&nbsp;response</span><span class="java_separator">.</span><span class="java_plain">getContentAsString</span><span class="java_separator">().</span><span class="java_plain">equals</span><span class="java_separator">(</span><span class="java_literal">&quot;foobar&quot;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}.</span><span class="java_plain">run</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre><p>
            This test only executes local calls, it does not communicate with the <code class="literal">SeamResourceServlet</code>
            through TCP. The mock request is passed through the Seam servlet and filters and the response is then
            available for test assertions. Overriding the <code class="literal">getDefaultHeaders()</code> method in a shared
            instance of <code class="literal">ResourceRequestEnvironment</code> allows you to set request headers for every
            test method in the test class.
         </p><p>
            Note that a <code class="literal">ResourceRequest</code> has to be executed in a <code class="literal">@Test</code> method
            or in a <code class="literal">@BeforeMethod</code> callback. You can not execute it in any other callback,
            such as <code class="literal">@BeforeClass</code>.
         </p></div></div></div><ul class="docnav"><li class="previous"><a accesskey="p" href="cache.html"><strong>Prev</strong>Chapter 23. Caching</a></li><li class="up"><a accesskey="u" href="#"><strong>Top of page</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Front page</strong></a></li><li class="next"><a accesskey="n" href="remoting.html"><strong>Next</strong>Chapter 25. Remoting</a></li></ul></body></html>